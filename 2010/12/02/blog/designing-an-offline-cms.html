<!DOCTYPE html>
<html lang='en'>
  <head>
    <meta charset='utf-8'>
    <title>Designing an Offline CMS - Michael Mior</title>
    <link href='/styles.css' rel='stylesheet'>
    <link href='/img/favicon.ico' rel='icon'>
    <meta content='nanoc 3.8.0' name='generator'>
    <link href='/atom.xml' rel='alternate' title='Michael Mior' type='application/atom+xml'>
    <link href='https://fonts.googleapis.com/css?family=Montserrat:400,700|Hind:400,700' rel='stylesheet'>
  </head>
  <body class='single-post'>
    <div class='hfeed' id='wrapper'>
      <div id='header'>
        <div id='blog-title'>
          <h1>
            <a href='/' rel='home' title='Michael Mior'>
              <span class='word-1'>Michael</span>
              <span class='word-2'>Mior</span>
            </a>
          </h1>
        </div>
        <div id='access'>
          <div class='skip-link'>
            <a href='#content' title='Skip navigation to the content'></a>
          </div>
          <div class='menu'>
            <ul class='sf-menu'>
              <li>
                <a href="/">Home</a>
              </li>
              <li>
                <a href="/about/">About</a>
              </li>
              <li>
                <a href="/contact/">Contact</a>
              </li>
              <li>
                <a href="/blog/archive/2015.html">Blog</a>
              </li>
              <li>
                <a href="/projects/">Projects</a>
              </li>
              <li>
                <a href="/publications/">Publications</a>
              </li>
            </ul>
          </div>
        </div>
      </div>
    </div>
    <div id='main'>
      <div id='container'>
        <div id='content'>
          <div class='post hentry'>
  <h1 class='entry-title'>Designing an Offline CMS</h1>
  <div class='entry-content'>&#x000A;            <p>First the obvious&nbsp;question.&#x000A;            What on earth is an offline&nbsp;<span class="caps">CMS</span>?&#x000A;            Isn’t the whole point of having a <span class="caps">CMS</span> that you don’t have to change anything offline? Well, yes that’s&nbsp;true.&#x000A;            But recently I ran into a&nbsp;problem.</p>&#x000A;            &#x000A;            <p>When I started my Masters degree, the department wanted me to create a webpage, but all I could really do was serve boring old static&nbsp;content.&#x000A;            Well, that’s not entirely true, since there was an offer to set up a reverse proxy with my own <span class="caps">LAMP</span> stack, but that seemed like overkill for my humble little&nbsp;homepage.&#x000A;            I also knew that I sure didn’t want to have to edit pages one by one every time I wanted to change common&nbsp;content.&#x000A;            I also didn’t want to have to upload things manually every time things&nbsp;changed.</p>&#x000A;            &#x000A;            <p>I did some searching around, and I decided to start with the <a href="http://www.cheetahtemplate.org/">Cheetah</a> template&nbsp;engine.&#x000A;            It’s got basically all the template goodness you need and a nice, clean&nbsp;syntax.&#x000A;            So I created some Cheetah templates, and wrote a little script to generate all my files, and everything worked just&nbsp;fine.&#x000A;            But I didn’t want to stop&nbsp;there.&#x000A;            So I decided to throw in some of the <a href="http://wiseheartdesign.com/articles/2010/01/18/the-demise-of-css-why-sass-and-languages-like-it-will-triumph/">goodness of <span class="caps">SASS</span></a>.&#x000A;            (If you’re not familiar with <span class="caps">SASS</span>, check out the link, it’ll change your&nbsp;life.)&#x000A;            Finally, just for good measure, I decided to throw in cssoptimizer and <a href="http://www.crockford.com/javascript/jsmin.html">jsmin</a> to pack everything down to&nbsp;size.</p>&#x000A;            &#x000A;            <p>Finally, just to satisfy my aching fingers, I decided to write a Makefile that would perform the whole shebang: generate the static <span class="caps">HTML</span>, optimize <span class="caps">JS</span> and <span class="caps">CSS</span> code, and upload any changes to the&nbsp;server.</p>&#x000A;            &#x000A;            <div class="highlighter-coderay">&#x000A;            <div class="CodeRay">&#x000A;              <div class="code"><pre><span class="line-numbers"> <a href="#n1" name="n1">1</a></span>SERVER = yourserverhere&#x000A;            <span class="line-numbers"> <a href="#n2" name="n2">2</a></span>&#x000A;            <span class="line-numbers"> <a href="#n3" name="n3">3</a></span>JS = $(wildcard src/js/*.js)&#x000A;            <span class="line-numbers"> <a href="#n4" name="n4">4</a></span>JS_OPT = $(patsubst src/js/%.js,web/js/%.js, $(JS))&#x000A;            <span class="line-numbers"> <a href="#n5" name="n5">5</a></span>&#x000A;            <span class="line-numbers"> <a href="#n6" name="n6">6</a></span>SASS = $(wildcard src/sass/*.sass)&#x000A;            <span class="line-numbers"> <a href="#n7" name="n7">7</a></span>CSS = $(patsubst src/sass/%.sass,web/css/%.css, $(SASS))&#x000A;            <span class="line-numbers"> <a href="#n8" name="n8">8</a></span>&#x000A;            <span class="line-numbers"> <a href="#n9" name="n9">9</a></span>TMPL = $(wildcard src/tmpl/*.tmpl)&#x000A;            <span class="line-numbers"><strong><a href="#n10" name="n10">10</a></strong></span>TMPL_INC = $(wildcard src/tmpl/inc/*.tmpl)&#x000A;            <span class="line-numbers"><a href="#n11" name="n11">11</a></span>HTM = $(patsubst src/tmpl/%.tmpl,web/%.htm, $(TMPL))&#x000A;            <span class="line-numbers"><a href="#n12" name="n12">12</a></span>&#x000A;            <span class="line-numbers"><a href="#n13" name="n13">13</a></span># Build all JavaScript, CSS, and XHTML files&#x000A;            <span class="line-numbers"><a href="#n14" name="n14">14</a></span>all: $(JS_OPT) $(CSS) $(HTM)&#x000A;            <span class="line-numbers"><a href="#n15" name="n15">15</a></span>&#x000A;            <span class="line-numbers"><a href="#n16" name="n16">16</a></span># Remove all built files from the output directory&#x000A;            <span class="line-numbers"><a href="#n17" name="n17">17</a></span>clean:&#x000A;            <span class="line-numbers"><a href="#n18" name="n18">18</a></span> rm -f web/*.htm&#x000A;            <span class="line-numbers"><a href="#n19" name="n19">19</a></span> rm -f web/js/*.js    rm -f web/css/*.css&#x000A;            <span class="line-numbers"><strong><a href="#n20" name="n20">20</a></strong></span>&#x000A;            <span class="line-numbers"><a href="#n21" name="n21">21</a></span># Upload the final site to the server&#x000A;            <span class="line-numbers"><a href="#n22" name="n22">22</a></span>put: all&#x000A;            <span class="line-numbers"><a href="#n23" name="n23">23</a></span> rsync -avr --delete web/ $(SERVER):~/public_html&#x000A;            <span class="line-numbers"><a href="#n24" name="n24">24</a></span>&#x000A;            <span class="line-numbers"><a href="#n25" name="n25">25</a></span># Optimize JavaScript files&#x000A;            <span class="line-numbers"><a href="#n26" name="n26">26</a></span>$(JS_OPT): web/js/%.js: src/js/%.js&#x000A;            <span class="line-numbers"><a href="#n27" name="n27">27</a></span> cat $&lt; | ./bin/jsmin &gt; $@&#x000A;            <span class="line-numbers"><a href="#n28" name="n28">28</a></span>&#x000A;            <span class="line-numbers"><a href="#n29" name="n29">29</a></span># Optimize CSS files&#x000A;            <span class="line-numbers"><strong><a href="#n30" name="n30">30</a></strong></span>$(CSS): web/css/%.css: src/sass/%.sass&#x000A;            <span class="line-numbers"><a href="#n31" name="n31">31</a></span> sass $&lt; | ./bin/cssoptimizer -i $@&#x000A;            <span class="line-numbers"><a href="#n32" name="n32">32</a></span>&#x000A;            <span class="line-numbers"><a href="#n33" name="n33">33</a></span># Ensure XHTML is rebuilt when included templates change&#x000A;            <span class="line-numbers"><a href="#n34" name="n34">34</a></span>$(HTM): $(TMPL_INC)&#x000A;            <span class="line-numbers"><a href="#n35" name="n35">35</a></span>&#x000A;            <span class="line-numbers"><a href="#n36" name="n36">36</a></span>$(HTM): web/%.htm: src/tmpl/%.tmpl&#x000A;            <span class="line-numbers"><a href="#n37" name="n37">37</a></span> (cd src/tmpl; cheetah fill --nobackup --oext=$(suffix $@) --odir=../../$(dir $@) $(notdir $&lt;))&#x000A;            </pre></div>&#x000A;            </div>&#x000A;            </div>&#x000A;            &#x000A;            <p>To get this to work for you, you should just be able to change <code>SERVER</code> to the address of your web&nbsp;server.&#x000A;            The directory structure I used looks like&nbsp;this:</p>&#x000A;            &#x000A;            <ul>&#x000A;            <li>bin</li>&#x000A;              <li>src&#x000A;                <ul>&#x000A;            <li>tmpl&#x000A;                    <ul>&#x000A;            <li>inc</li>&#x000A;                    </ul>&#x000A;            </li>&#x000A;                  <li>sass</li>&#x000A;                  <li>js</li>&#x000A;                </ul>&#x000A;            </li>&#x000A;              <li>web&#x000A;                <ul>&#x000A;            <li>img</li>&#x000A;                </ul>&#x000A;            </li>&#x000A;            </ul><p>Finally, here’s a complete list of download locations for all the tools I&nbsp;used:</p>&#x000A;            &#x000A;            <ul>&#x000A;            <li><a href="http://sass-lang.com/">Sass – Syntactically Awesome&nbsp;Stylesheets</a></li>&#x000A;              <li><a href="http://www.crockford.com/javascript/jsmin.html"><span class="caps">JSMIN</span>, The JavaScript&nbsp;Minifier</a></li>&#x000A;              <li><a href="http://mabblog.com/cssoptimizer/download.html"><span class="caps">CSS</span>&nbsp;Optimizer</a></li>&#x000A;            </ul><p>I found out when researching for this post that <a href="http://twitter.com/lakshmivyas">Lakshmi Vyas</a> has already come up with a solution called <a href="http://ringce.com/hyde">Hyde</a> for&nbsp;Python.&#x000A;            There is also <a href="http://jekyllrb.com/">jekyll</a> which uses&nbsp;Ruby.&#x000A;            This just gives you more approaches to building a custom tool that suits your&nbsp;needs.</p>&#x000A;            &#x000A;            <p>If you have any tips for generating static web content, post in the&nbsp;comments!</p>&#x000A;</div>
</div>

        </div>
      </div>
    </div>
    <div id='footer'>
      <div id='siteinfo'>
        &copy; 2016 Michael Mior
      </div>
    </div>
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
      
      ga('create', 'UA-45085128-1', 'mior.ca');
      ga('require', 'linkid', 'linkid.js');
      ga('send', 'pageview');
      
      window.heap=window.heap||[],heap.load=function(t,e){window.heap.appid=t,window.heap.config=e;var a=document.createElement("script");a.type="text/javascript",a.async=!0,a.src=("https:"===document.location.protocol?"https:":"http:")+"//cdn.heapanalytics.com/js/heap-"+t+".js";var n=document.getElementsByTagName("script")[0];n.parentNode.insertBefore(a,n);for(var o=function(t){return function(){heap.push([t].concat(Array.prototype.slice.call(arguments,0)))}},p=["clearEventProperties","identify","setEventProperties","track","unsetEventProperty"],c=0;c<p.length;c++)heap[p[c]]=o(p[c])};
      heap.load('1282501007');
    </script>
  </body>
</html>
